{{ define "title " }}{{ .Title | htmlUnescape }} - {{ .Section }} - {{ end }}
{{ define "ogTitle " }}{{ .Title | htmlUnescape }} - {{ .Section }} - {{ end }}
{{ define "twitterTitle " }}{{ .Title | htmlUnescape }} - {{ .Section }} - {{ end }}

{{ define "pageType" }}single{{ end }}

{{ define "header-title" }}

<div class="column large-2 medium-1 small-hide">&nbsp;</div>
<div class="column large-8 medium-10 small-12">

	<div class="article-social-share-links-container type-heading">
		{{ partial "article-social-share-links" . }}
	</div>
	<a href="#">
		<h1 class="type-heading">{{ .Title | htmlUnescape }}</h1>
	</a>

</div>
<div class="column large-2 medium-1 small-hide">&nbsp;</div>

{{ end }}

{{ define "main" }}

	<article>

		<div class="grid">
			<div class="row">

				<div class="column large-2 medium-1 small-hide">&nbsp;</div>

				<div class="column large-8 medium-10 small-12">
					{{ partial "article-attributes" . }}
				</div>

				<div class="column large-2 medium-1 small-hide">&nbsp;</div>

			</div>
		</div>

		<div class="grid hero-grid">
			<div class="row">

				<div class="column large-2 medium-1 medium-hide small-hide">&nbsp;</div>

				<div class="column large-8 medium-12 small-12">
					{{ partial "article-hero" . }}
				</div>

				<div class="column large-2 medium-1 medium-hide small-hide">&nbsp;</div>

			</div>
		</div>

		{{ if .Params.ImageCreditUrl }}
		<div class="grid image-credit-grid">
			<div class="row">

				<div class="column large-2 medium-1 small-hide">&nbsp;</div>

				<div class="column large-8 medium-10 small-12">

					<a class="type-credits lighter"
						href="{{ .Params.ImageCreditUrl }}"
						rel="noopener noreferrer"
						target="_blank">
						Image credit{{ if .Params.ImageCreditHandle }}: {{ .Params.ImageCreditHandle }}{{ end }}
					</a>

				</div>

				<div class="column large-2 medium-1 small-hide">&nbsp;</div>

			</div>
		</div>
		{{ end }}

		<div class="grid content-grid">

			<div class="row">

				<div class="column large-2 medium-1 xlarge-hide large-hide small-hide">&nbsp;</div>

				<div class="column large-10 medium-10 small-12">

					{{ partial "table-of-contents" . }}

					<div class="contents">

						<div class="contents-inner">
							{{ partial "drop-cap-content" . }}
						</div>

						{{ partial "tag-list" . }}

						{{ partial "article-social-share-links" . }}

					</div>

				</div>

				<div class="column large-2 medium-10 medium-centered small-12">
					{{ with .Params.Series }}
						<aside class="article-series large-text-right medium-text-left">
							<span class="type-label lighter">series</span>
							{{ . }}
						</aside>
					{{ end }}
					&nbsp;
				</div>

			</div>

		</div>

	</article>

	<aside class="article-author-drawer">

		<div class="grid">
			<div class="row">

				<div class="column large-2 medium-1 small-hide">&nbsp;</div>

				<div class="column large-8 medium-10 small-12">
					{{ .Scratch.Set "includeBio" "true" }}
					{{ partial "author-drawer" . }}
				</div>

				<div class="column large-2 medium-1 small-hide">&nbsp;</div>

			</div>
		</div>

	</aside>

	<aside class="article-navigation-drawer">

		<div class="grid">
			<div class="row">

				<div class="column large-2 medium-1 small-hide">&nbsp;</div>

				<div class="column large-8 medium-10 small-12">

					{{ partial "navigation-drawer" . }}

				</div>

				<div class="column large-2 medium-1 small-hide">&nbsp;</div>

			</div>
		</div>

	</aside>

{{ end }}

{{ define "aside" }}

	<div class="disqus"></div>

{{ end }}

{{ define "body-trailer" }}

<link rel="stylesheet" href="/css/monokai-light.css">

<script async src="/scripts/sticky-nav.js"></script>
<script async src="/scripts/social-share-links.js"></script>

<script src="/scripts/vendor/lazyload.min.js"></script>
<script src="/scripts/vendor/disqusloader.js"></script>

<script>

	// Initializes lazy-loading behavior

	const lazyLoadInstance = new LazyLoad({
		callback_error: (img) => {

			img.parentElement.querySelector('source[srcset*=".webp"]')
				.remove()

			img.dataset.srcset = img.dataset.srcset
				.replace('.webp', '.png')

			img.setAttribute('srcset',
				img.getAttribute('srcset').replace('.webp', '.png')
			)

		},
	});

	// Initializes disqus asynchronously

	disqusLoader( '.disqus', {
		scriptUrl: '//zalla-io.disqus.com/embed.js',
	});

</script>
{{ end }}
